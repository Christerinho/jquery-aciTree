
/*
 * aciTree jQuery Plugin v2.1.0
 * http://acoderinsights.ro
 *
 * Copyright (c) 2013 Dragos Ursu
 * Dual licensed under the MIT or GPL Version 2 licenses.
 *
 * Require jQuery Library >= v1.7.1 http://jquery.com
 *
 * Date: Sun Mar 02 14:20 2013 +0200
 */

(function(a){a.aciTree={nameSpace:".aciTree"};a.fn.aciTree=function(c,f,g){var b=null;for(var e=0,d=this.length;e<d;e++){b=a(this[e])._aciTree(c,f,g);if(!(b instanceof jQuery)){return b}}return this};a.fn.aciTree.defaults={jsonUrl:null,rootData:null,threads:4,queueDelay:40,loaderDelay:500,expand:false,collapse:false,unique:false,empty:false,selectable:true,show:{props:{height:"show"},duration:"medium",easing:"linear"},animateRoot:true,hide:{props:{height:"hide"},duration:"medium",easing:"linear"},view:{duration:"medium",easing:"linear"},autoInit:true,callbacks:{item:null,selected:null}};a.fn._aciTree=function(ae,K,M){var I=this;var u=I.data(a.aciTree.nameSpace);if(!u&&((typeof ae=="undefined")||(typeof ae=="object"))){u={options:a.extend({},a.fn.aciTree.defaults,ae),wasInit:false,locked:false};I.data(a.aciTree.nameSpace,u)}var ap=function(){if(!u){h(null,"initerr");return}if(c()){h(null,"wasinit");return}if(au()){h(null,"locked");return}u.locked=true;I.on("click"+a.aciTree.nameSpace,".aciTreeButton",function(aQ){var aP=a(aQ.target).parent();ad(aP,{collapse:u.options.collapse,expand:u.options.expand,unique:u.options.unique})});var aO=function(){u.wasInit=true;u.locked=false;h(null,"init")};var aN=function(){u.wasInit=true;u.locked=false;h(null,"initfail")};if(u.options.rootData){aa(null,{success:aO,fail:aN,itemData:u.options.rootData})}else{if(u.options.jsonUrl){l(null,{success:aO,fail:aN})}else{aO()}}};var c=function(){return u&&u.wasInit};var au=function(){return u&&u.locked};var az=function(aR,aN){var aQ=[];var aT=[];var aO=aR?Math.max(aR,1):1;var aS=0;var aP=false;this.push=function(aV,aU){if(!aP){aQ.push({callback:aV,async:aU})}return this};this.complete=function(aV,aU){if(!aP){aT.push({callback:aV,async:aU})}return this};this.destroy=function(){aP=true;setTimeout(function(){aT=[];aQ=[];aS=0;aP=false},u.options.queueDelay)};this.busy=function(){return aS>=aO};this.empty=function(){return(aS==0)&&(aQ.length==0)&&(aT.length==0)};this.run=function(aW){if((aS>=aO)||aP){return}if(aW){for(var aV=1,aU=aO-aS;aV<aU;aV++){this.run()}}var aX=this;setTimeout(function(){if((aS>=aO)||aP){return}var aY=aQ.shift();if(!aY){if(aQ.length){setTimeout(function(){aX.run()},10)}else{aY=aT.shift()}}if(aY){if(aY.async){aS++;aY.callback(function(){aS--;aX.run()})}else{aS++;aY.callback();aS--;aX.run()}}},aN?10:u.options.queueDelay)}};var aE=function(aP,aQ,aN){var aO=a.extend({success:null,fail:null,expand:false,collapse:false,unique:false,unanimated:false,itemData:null},aP);if(aQ){if(aP&&aP.success){aO.success=function(){aQ();aP.success()}}else{aO.success=aQ}}if(aN){if(aP&&aP.fail){aO.fail=function(){aN();aP.fail()}}else{aO.fail=aN}}return aO};var h=function(aO,aN,aP){aP=a.extend({event:aN},aP);I.trigger("acitree",[an,aO,aP])};var ab=function(aO,aN,aP){if(aN&&aN.success){aN.success(an,aO?aO.first():null,aP)}};var g=function(aO,aN,aP){if(aN&&aN.fail){aN.fail(an,aO?aO.first():null,aP)}};var l=function(aO,aN){aN=aE(aN,function(){aI(aO,false);h(aO,"loaded")},function(){aI(aO,false);h(aO,"loadfail")});if(!aO||r(aO)){i.push(function(aP){if(X(aO)){ab(aO,aN);aP();return}aI(aO,true);a.get(u.options.jsonUrl+(aO?q(aO):""),function(aQ){if(aQ&&(aQ instanceof Array)&&aQ.length){var aR=function(){if(X(aO)){ag(aO,{success:function(){H(aO,aQ);ab(aO,aN);aP()},fail:function(){g(aO,aN);aP()},unanimated:aN.unanimated})}else{H(aO,aQ);ab(aO,aN);aP()}};aM(aO,{success:aR,fail:aR})}else{var aR=function(){g(aO,aN);aP()};aC(aO,{success:aR,fail:aR})}},"json").fail(function(){g(aO,aN);aP()})},true).run()}else{g(aO,aN)}};var aa=function(aO,aN){aN=aE(aN,function(){aI(aO,false);h(aO,"loaded")},function(){aI(aO,false);h(aO,"loadfail")});if(!aO||r(aO)){if(X(aO)){ab(aO,aN);return}aI(aO,true);if(aN.itemData&&(aN.itemData instanceof Array)&&aN.itemData.length){var aP=function(){if(X(aO)){ag(aO,{success:function(){H(aO,aN.itemData);ab(aO,aN)},fail:aN.fail,unanimated:aN.unanimated})}else{H(aO,aN.itemData);ab(aO,aN)}};aM(aO,{success:aP,fail:aP})}else{aC(aO,{success:aN.fail,fail:aN.fail})}}else{g(aO,aN)}};var ag=function(aO,aN){aN=aE(aN,function(){h(aO,"unloaded")},function(){h(aO,"unloadfail")});if(!aO||r(aO)){aI(aO,true);ah(aO,true).each(function(){var aP=a(this);if(r(aP)){h(aP,"closed");h(aP,"unloaded")}h(aP,"removed")});if(aO){if(D(aO)){Y(aO,{success:function(){aI(aO);Q(aO);ab(aO,aN)},fail:function(){aI(aO);g(aO,aN)},unanimated:aN.unanimated})}else{aI(aO);Q(aO);ab(aO,aN)}}else{ay(aO,false,!u.options.animateRoot||aN.unanimated,function(){aI(aO);Q(aO);ab(aO,aN)})}}else{g(aO,aN)}};var U=function(aO,aN){aN=aE(aN,function(){h(aO,"removed")},function(){h(aO,"removefail")});if(b(aO)){if(r(aO)){if(X(aO)){ag(aO,{success:function(){ab(aO,aN);aO.remove()},fail:aN.fail,unanimated:aN.unanimated})}else{ab(aO,aN);aO.remove()}}else{ab(aO,aN);aO.remove()}}else{g(aO,aN)}};var af=function(aP,aO){if(aO.expand){var aN=new az(u.options.threads,true);ah(aP).each(function(){var aQ=a(this);if(r(aQ)){if(D(aQ)){h(aQ,"opened")}else{aN.push(function(aR){T(aQ,{success:aR,fail:aR,expand:true,unanimated:aO.unanimated})},true)}}});aN.complete(function(){ab(aP,aO)}).run(true)}else{ab(aP,aO)}};var am=function(aO,aN){if(!aN.unanimated&&!aD(aO)){aN.unanimated=true}if(aN.unique){aq(aO);aN.unique=false}ay(aO,true,aN.unanimated,function(){aO.addClass("aciTreeOpen");af(aO,aN)})};var T=function(aO,aN){aN=aE(aN,function(){h(aO,"opened")},function(){h(aO,"openfail")});if(r(aO)){if(D(aO)){af(aO,aN)}else{if(X(aO)){am(aO,aN)}else{l(aO,{success:function(){am(aO,aN)},fail:aN.fail})}}}else{g(aO,aN)}};var aK=function(aP,aO){if(u.options.empty){aO.unanimated=true;ag(aP,aO)}else{if(aO.collapse){var aN=new az(u.options.threads,true);ah(aP).each(function(){var aQ=a(this);if(r(aQ)){if(D(aQ)){aN.push(function(aR){Y(aQ,{success:aR,fail:aR,collapse:true,unanimated:true})},true)}else{h(aQ,"closed")}}});aN.complete(function(){ab(aP,aO)}).run(true)}else{ab(aP,aO)}}};var N=function(aO,aN){if(!aN.unanimated&&!aD(aO)){aN.unanimated=true}ay(aO,false,aN.unanimated,function(){aO.removeClass("aciTreeOpen");aK(aO,aN)})};var Y=function(aO,aN){aN=aE(aN,function(){h(aO,"closed")},function(){h(aO,"closefail")});if(r(aO)){if(D(aO)){N(aO,aN)}else{if(X(aO)){aK(aO,aN)}else{ab(aO,aN)}}}else{g(aO,aN)}};var aq=function(aQ,aP){aP=aE(aP);if(b(aQ)){var aN=new az(u.options.threads,true);var aO=aQ.add(x(aQ)).add(ah(aQ,true));ah(null,true).filter(".aciTreeOpen").not(aO).each(function(){var aR=a(this);aN.push(function(aS){Y(aR,{success:aS,fail:aS,unanimated:aP.unanimated})},true)});aN.complete(function(){ab(aQ,aP)}).run(true)}else{g(aQ,aP)}};var ad=function(aO,aN){if(D(aO)){Y(aO,aN)}else{T(aO,aN)}};var x=function(aO,aN){if(aO){var aP=function(aR){var aS=[];var aQ=aR.parent().parent();if(aQ.hasClass("aciTreeLi")){aS=aN?aS.concat(aQ.get(0),aP(aQ)):aS.concat(aP(aQ),aQ.get(0))}return aS};return a(aP(aO.first()))}return a([])};var ac=function(aP,aO){aO=aE(aO);var aQ=x(aP);if(aQ.length){var aN=new az(null,true);aQ.each(function(){var aR=a(this);if(D(aR)){h(aR,"opened")}else{aN.push(function(aS){T(aR,{success:aS,fail:aS,unanimated:aO.unanimated})},true)}});aN.complete(function(){ab(aP,aO)}).run()}else{g(aP,aO)}};var aD=function(aQ){var aR=true;x(aQ).each(function(){if(!a(this).is(":visible")){aR=false;return false}});if(aR){var aP=I.get(0).getBoundingClientRect();var aO=aQ.first().find(".aciTreeItem");var aS=aO.get(0).getBoundingClientRect();var aN=aO.height();if((aS.bottom-aN<aP.top)||(aS.top+aN>aP.bottom)||(aS.right<aP.left)||(aS.left>aP.right)){return false}return true}return false};var B=function(aO,aN){aN=aE(aN);if(aD(aO)){ab(aO,aN)}else{ac(aO,{success:function(){var aR=I.get(0).getBoundingClientRect();var aQ=aO.first().find(".aciTreeItem");var aS=aQ.get(0).getBoundingClientRect();var aP=aQ.height();if(aS.bottom-aP<aR.top){if(!aN.unanimated&&u.options.view){I.animate({scrollTop:I.scrollTop()-aR.top+aS.bottom-aP},{duration:u.options.view.duration,easing:u.options.view.easing,complete:function(){ab(aO,aN)}})}else{I.scrollTop(I.scrollTop()-aR.top+aS.bottom-aP);ab(aO,aN)}}else{if(aS.top+aP>aR.bottom){if(!aN.unanimated&&u.options.view){I.animate({scrollTop:I.scrollTop()+aS.top-aR.bottom+aP},{duration:u.options.view.duration,easing:u.options.view.easing,complete:function(){ab(aO,aN)}})}else{I.scrollTop(I.scrollTop()+aS.top-aR.bottom+aP);ab(aO,aN)}}else{ab(aO,aN)}}},fail:aN.fail})}};var e=function(aO){if(aO){var aN=aO.first().parent().parent();return aN.hasClass("aciTreeLi")}return false};var y=function(aN){return aN?aN.first().parent().parent().filter(".aciTreeLi"):a([])};var ak=function(aN){if(b(aN)){var aO=x(aN);return aO.length?aO.eq(0):a([])}return a([])};var H=function(aR,aO){if(aR){aR.removeClass("aciTreeFolderMaybe").addClass("aciTreeFolder")}var aP=O(aR,{itemData:aO});var aN;for(var aQ in aO){aN=aO[aQ];if(aN.items&&(aN.items instanceof Array)&&aN.items.length){H(aP.eq(aQ),aN.items)}if(aN.props&&aN.props.open){T(aP.eq(aQ))}}};var L=function(aO,aN){aN=aE(aN);if(b(aO)){if(aN.itemData.props&&(aN.itemData.props.isFolder||(aN.itemData.props.isFolder===null))){var aP=function(){aG(aO,aN.itemData.id);ao(aO,aN.itemData.item);if(aN.itemData.props){aj(aO,aN.itemData.props.icon)}aO=aO.first();aO.removeClass("aciTreeFolder aciTreeFolderMaybe").addClass((aN.itemData.props.isFolder||(aN.itemData.items&&aN.itemData.items.length))?"aciTreeFolder":"aciTreeFolderMaybe");if(aN.itemData.items){if(X(aO)){ag(aO,{success:function(){aa(aO,{success:aN.success,fail:aN.fail,itemData:aN.itemData.items})},fail:aN.fail,unanimated:aN.unanimated})}else{aa(aO,{success:aN.success,fail:aN.fail,itemData:aN.itemData.items})}}else{ab(aO,aN)}};aM(aO,{success:aP,fail:aN.fail})}else{var aP=function(){aG(aO,aN.itemData.id);ao(aO,aN.itemData.item);if(aN.itemData.props){aj(aO,aN.itemData.props.icon)}};aC(aO,{success:aP,fail:aN.fail})}}else{g(aO,aN)}};var v=function(aO,aP,aN,aQ){if(u.options.callbacks&&u.options.callbacks.item){u.options.callbacks.item(aO,aP,aN,aQ);return}ao(aP,aN.item)};var A=function(aO,aQ,aR){var aN=a('<li class="aciTreeLi"></li>').data("id"+a.aciTree.nameSpace,aO.id);var aP='<div class="aciTreeButton"><div></div></div><div class="aciTreeItem">';if(aO.props&&aO.props.icon){if(aO.props.icon instanceof Array){aP+='<div class="aciTreeIcon '+aO.props.icon[0]+'" style="background-position:'+aO.props.icon[1]+"px "+aO.props.icon[2]+'px"></div>'}else{aP+='<div class="aciTreeIcon '+aO.props.icon+'"></div>'}}aN.append(aP+"</div>");if(aO.props&&(aO.props.isFolder||(aO.props.isFolder===null))){aN.addClass((aO.props.isFolder||(aO.items&&aO.items.length))?"aciTreeFolder":"aciTreeFolderMaybe")}else{aN.addClass("aciTreeFile")}v(an,aN,aO,aR);return aN};var V=function(aQ,aR,aT,aN,aS,aU){if(aN){var aO=[];if(aN instanceof Array){for(var aP in aN){aO[aO.length]=A(aN[aP],aS,aU).get(0)}}else{aO[aO.length]=A(aN,aS,aU).get(0)}aO=a(aO);if(aQ){aQ.append(aO)}else{if(aR){aR.before(aO)}else{if(aT){aT.after(aO)}}}return aO}return a([])};var Q=function(aO,aP){if(!aO){aO=I}var aN=aO.find(">.aciTreeUl");if(aP){if(!aN.length){aN=a('<ul class="aciTreeUl" style="display:none"></ul>');aO.append(aN)}return aN}aN.remove()};var O=function(aP,aN){aN=aE(aN,function(){h(aP,"appended")},function(){h(aP,"appendfail")});if(aP){if(r(aP)){aP=aP.first();var aO=Q(aP,true);var aQ=V(aO,null,null,aN.itemData,x(aP).add(aP),ax(aP)+1);if(aQ.length){aP.addClass("aciTreeFolder").removeClass("aciTreeFolderMaybe");aQ.each(function(){h(a(this),"added")})}else{if(!ah(aP).length){aO.remove()}}ab(aP,aN);return aQ}else{g(aP,aN);return a([])}}else{var aO=Q(I,true);var aQ=V(aO,null,null,aN.itemData,null,0);if(aQ.length){ay(null,true,!u.options.animateRoot||aN.unanimated);aQ.each(function(){h(a(this),"added")})}else{if(!ah().length){aO.remove()}}ab(aP,aN);return aQ}};var P=function(aO,aN){aN=aE(aN,function(){h(aO,"before")},function(){h(aO,"beforefail")});if(b(aO)){aO=aO.first();var aP=V(null,aO,null,aN.itemData,x(aO),ax(aO));aP.each(function(){h(a(this),"added")});ab(aO,aN);return aP}else{g(aO,aN);return a([])}};var ar=function(aO,aN){aN=aE(aN,function(){h(aO,"after")},function(){h(aO,"afterfail")});if(b(aO)){aO=aO.first();var aP=V(null,null,aO,aN.itemData,x(aO),ax(aO));aP.each(function(){h(a(this),"added")});ab(aO,aN);return aP}else{g(aO,aN);return a([])}};var p=function(aN){if(aN){var aO=a(aN).first();if(aO.hasClass("aciTree")){return a([])}else{if(aO.hasClass("aciTreeLi")){return aO}else{return aO.parents(".aciTreeLi:first")}}}return a([])};var ah=function(aO,aN){if(!aO){aO=I}return aO.first().find(aN?">.aciTreeUl .aciTreeLi":">.aciTreeUl>.aciTreeLi")};var r=function(aN){return aN&&(aN.first().hasClass("aciTreeFolder")||aN.first().hasClass("aciTreeFolderMaybe"))};var n=function(aN){return aN&&aN.first().hasClass("aciTreeFile")};var X=function(aN){if(!aN){return I.find(">.aciTreeUl").length>0}if(r(aN)){return aN.first().find(">.aciTreeUl").length>0}return true};var aM=function(aO,aN){aN=aE(aN,function(){h(aO,"folderset")});if(b(aO)){if(n(aO)){aO.first().removeClass("aciTreeFile").addClass("aciTreeFolder")}ab(aO,aN)}else{g(aO,aN)}};var aC=function(aO,aN){aN=aE(aN,function(){h(aO,"fileset")});if(b(aO)){if(r(aO)){if(X(aO)){ag(aO,{success:function(){aO.first().removeClass("aciTreeFolder aciTreeFolderMaybe aciTreeOpen").addClass("aciTreeFile");ab(aO,aN)},fail:aN.fail,unanimated:aN.unanimated})}else{aO.first().removeClass("aciTreeFolder aciTreeFolderMaybe aciTreeOpen").addClass("aciTreeFile");ab(aO,aN)}}else{ab(aO,aN)}}else{g(aO,aN)}};var aj=function(aP,aO){if(b(aP)){aP=aP.first();var aN=aP.find(">.aciTreeItem");var aQ=aN.find(">.aciTreeIcon:first-child");if(aQ.length){if(aO){if(aO instanceof Array){aQ.attr("class","aciTreeIcon "+aO[0]).css("background-position",aO[1]+"px "+aO[2]+"px")}else{aQ.attr("class","aciTreeIcon "+aO)}}else{aQ.remove()}}else{if(aO){if(aO instanceof Array){aN.prepend('<div class="aciTreeIcon '+aO[0]+'" style="background-position:'+aO[1]+"px "+aO[2]+'px"></div>')}else{aN.prepend('<div class="aciTreeIcon '+aO+'"></div>')}}}return true}return false};var ao=function(aR,aQ){if(b(aR)){aR=aR.first();var aN=Z(aR);var aO=aR.find(">.aciTreeItem");var aP=aO.find(">.aciTreeIcon:first-child").detach();aO.html(aQ).prepend(aP);h(aR,"itemset",{oldText:aN});return true}return false};var D=function(aN){return aN&&aN.first().hasClass("aciTreeOpen")};var aJ=function(aN){return !D(aN)};var at=function(aO,aN){return ah(aO,aN).length>0};var aw=function(aN){return aN&&(aN.first().siblings(".aciTreeLi:first").length>0)};var d=function(aN){return f(aN).length>0};var G=function(aN){return J(aN).length>0};var av=function(aN){return aN?aN.first().siblings(".aciTreeLi"):a([])};var f=function(aN){return aN?aN.first().prev(".aciTreeLi"):a([])};var J=function(aN){return aN?aN.first().next(".aciTreeLi"):a([])};var ax=function(aN){var aO=-1;if(aN){aN=aN.first();while(aN.hasClass("aciTreeLi")){aN=aN.parent().parent();aO++}}return aO};var q=function(aN){return aN?aN.first().data("id"+a.aciTree.nameSpace):null};var aG=function(aO,aP){if(aP&&b(aO)){var aN=q(aO);aO.first().data("id"+a.aciTree.nameSpace,aP);h(aO,"idset",{oldId:aN});return true}return false};var k=function(aO){if(b(aO)){var aN=aO.parent();return aN.find(">.aciTreeLi").index(aO.first())}return null};var Z=function(aN){return(aN?aN.first().find(">.aciTreeItem").text():null)};var aF=function(aO,aN){if(b(aO)&&b(aN)&&!s(aO,aN)&&!s(aN,aO)&&(aO.get(0)!=aN.get(0))){aO=aO.first();aN=aN.first();var aR=f(aO);if(aR.length){if(aN.get(0)==aR.get(0)){aN.before(aO)}else{aO.insertAfter(aN);aN.insertAfter(aR)}}else{var aQ=J(aO);if(aQ.length){if(aN.get(0)==aQ.get(0)){aN.after(aO)}else{aO.insertAfter(aN);aN.insertBefore(aQ)}}else{var aP=aO.parent();aO.insertAfter(aN);aP.append(aN)}}h(null,"swapped",{item1:aO,item2:aN});return true}return false};var ai=function(aP){if(b(aP)){var aO=f(aP);var aN=k(aP);if(aO.length){aO.before(aP.first())}h(aP,"movedup",{oldIndex:aN});return true}return false};var aA=function(aP){if(b(aP)){var aO=J(aP);var aN=k(aP);if(aO.length){aO.after(aP.first())}h(aP,"moveddown",{oldIndex:aN});return true}return false};var E=function(aP){if(b(aP)){var aO=y(aP);if(!aO.length){aO=I}var aN=k(aP);aO.find(">.aciTreeUl").prepend(aP.first());h(aP,"movedfirst",{oldIndex:aN});return true}return false};var m=function(aP){if(b(aP)){var aO=y(aP);if(!aO.length){aO=I}var aN=k(aP);aO.find(">.aciTreeUl").append(aP.first());h(aP,"movedlast",{oldIndex:aN});return true}return false};var s=function(aO,aN){if(b(aN)){return(ah(aO,true).filter(aN.first()).length==1)}return false};var aL=function(aP,aO){if(b(aO)){var aN=y(aO);if(aN.length){return aP&&(aN.get(0)==aP.get(0))}else{return !aP}}return false};var al=function(aP,aN){if(b(aP)&&b(aN)){var aQ=y(aP);var aO=y(aN);return(!aQ.length&&!aO.length)||(aQ.get(0)==aO.get(0))}return false};var aH=function(aP,aN){if(b(aP)&&b(aN)){var aQ=ak(aP);var aO=ak(aN);return(!aQ.length&&!aO.length)||(aQ.get(0)==aO.get(0))}return false};var F=function(aU,aR){var aT=ah(aU);var aV,aN,aP,aX,aS=false;for(var aQ=0,aW=aT.length;aQ<aW;aQ++){aV=aT.eq(aQ);aN=aV.data("id"+a.aciTree.nameSpace);if(aN){aP=aN.length;if(aP){if(aN==aR.substr(0,aP)){aX=aV;aS=aR.length==aP;break}}}}if(aX){if(!aS){var aO=F(aX,aR);if(aO){return aO}}return{item:aX,exact:aS}}else{return null}};var w=function(aU,aT,aR,aN){aN=aE(aN);if(aU){if(aT){if(aR){var aS=function(aV){var aW=F(aV,aU);if(aW){if(aW.exact){ab(aW.item,aN)}else{if(X(aW.item)){g(aV,aN)}else{l(aW.item,{success:function(){aS(aW.item)},fail:aN.fail})}}}else{g(aV,aN)}};aS();return a([])}else{var aQ=F(null,aU);if(aQ&&aQ.exact){ab(aQ,aN);return aQ.item}}}else{var aP=[];var aO="id"+a.aciTree.nameSpace;I.find(".aciTreeLi").each(function(){if(a(this).data(aO)==aU){aP[aP.length]=this}});if(aP.length){var aQ=a(aP);ab(aQ,aN,aQ);return aQ}}}g(null,aN);return a([])};var b=function(aN){return aN&&aN.first().hasClass("aciTreeLi")};var ay=function(aQ,aR,aP,aS){if(!aQ){aQ=I}if(!aP){var aO=aR?u.options.show:u.options.hide;if(aO){var aN=aQ.first().find(">.aciTreeUl");if(aN.length){aN.stop(true).animate(aO.props,{duration:aO.duration,easing:aO.easing,complete:aS})}else{if(aS){aS()}}return}}aQ.first().find(">.aciTreeUl").stop(true).toggle(aR);if(aS){aS()}};var i=new az(u?u.options.threads:null);var aB=function(aN){if(!aN){aN=I}return aN.first().find(">.aciTreeUl>.aciTreeLi:first")};var t=function(aN){if(!aN){aN=I}return aN.first().find(">.aciTreeUl>.aciTreeLi:last")};var W=function(aN){if(aN){return aN.first().hasClass("aciTreeLoad")}else{return !i.empty()||!j.empty()}};var aI=function(aN,aO){if(aN){aN.toggleClass("aciTreeLoad",aO)}else{if(aO){R(aO)}}};var o=null;var C=null;var R=function(aN){if(aN||W()){if(!C){C=setInterval(R,u.options.loaderDelay)}I.toggleClass("aciTreeLoad",true);clearTimeout(o);o=setTimeout(function(){I.toggleClass("aciTreeLoad",false)},u.options.loaderDelay*2)}};var j=new az(null,true);var z=function(aN,aQ,aO){var aP=function(aS,aU,aR){var aT=aR?J(aS):aB(aS);if(aT.length){if(r(aT)){if(X(aT)){j.push(function(){aU(an,aT);aP(aT,aU);aP(aT,aU,true)}).run()}else{if(aO){j.push(function(aV){l(aT,{success:function(){aU(an,aT);aP(aT,aU);aP(aT,aU,true);aV()},fail:function(){aP(aT,aU,true);aV()}})},true).run()}else{j.push(function(){aU(an,aT);aP(aT,aU,true)}).run()}}}else{j.push(function(){aU(an,aT);aP(aT,aU,true)}).run()}}};aP(aN,aQ)};var S=function(){if(c()){if(au()){h(null,"locked")}u.locked=true;I.toggleClass("aciTreeLoad",true);j.destroy();i.destroy();ag(null,{success:function(){clearTimeout(o);clearInterval(C);I.off(a.aciTree.nameSpace,".aciTreeButton");I.data(a.aciTree.nameSpace,null);u.wasInit=false;I.toggleClass("aciTreeLoad",false);u.locked=false;h(null,"destroyed")},fail:function(){I.toggleClass("aciTreeLoad",false);u.locked=false;h(null,"destroyfail")}})}else{h(null,"notinit")}};var an={itemFrom:p,getId:q,getText:Z,getLevel:ax,getIndex:k,searchId:w,isItem:b,isFile:n,isFolder:r,wasLoad:X,setId:aG,setFolder:aM,setFile:aC,setIcon:aj,setItem:ao,update:L,haveParent:e,getParent:y,getTopParent:ak,getPath:x,sameParent:al,sameTopParent:aH,after:ar,before:P,append:O,unload:ag,remove:U,swap:aF,moveUp:ai,moveDown:aA,moveFirst:E,moveLast:m,toggle:ad,open:T,openPath:ac,close:Y,closeOthers:aq,isOpen:D,isClosed:aJ,isVisible:aD,setVisible:B,haveSiblings:aw,havePrev:d,haveNext:G,haveChildrens:at,isChildren:s,isImmediateChildren:aL,siblings:av,getFirst:aB,getLast:t,getPrev:f,getNext:J,childrens:ah,initFrom:aa,ajaxLoad:l,isBusy:W,branch:z,init:ap,wasInit:c,isLocked:au,option:function(aN,aO){if(u){u.options[aN]=aO;I.data(a.aciTree.nameSpace,u)}},options:function(){return u?u.options:null},destroy:S};if((typeof ae=="undefined")||(typeof ae=="object")){if(u.options.autoInit){ap()}}else{if(typeof ae=="string"){switch(ae){case"init":ap();break;case"api":return an;case"option":if(u){u.options[K]=M;I.data(a.aciTree.nameSpace,u)}break;case"options":return u?u.options:null;case"destroy":S();break}}}return I}})(jQuery);
